!function(){"use strict";var t={121:function(t){t.exports=ShortcodeSerialiser},145:function(t){t.exports=ReactDomClient},153:function(t){t.exports=TinyMCEActionRegistrar},207:function(t){t.exports=Injector},508:function(t){t.exports=InsertLinkModal},518:function(t){t.exports=ReactDom},594:function(t){t.exports=React},669:function(t){t.exports=jQuery},815:function(t){t.exports=i18n}},e={};function n(i){var a=e[i];if(void 0!==a)return a.exports;var r=e[i]={exports:{}};return t[i](r,r.exports,n),r.exports}!function(){var t=d(n(815)),e=d(n(153)),i=d(n(594)),a=(d(n(518)),n(145)),r=d(n(669)),o=d(n(121)),s=n(508),l=n(207);function d(t){return t&&t.__esModule?t:{default:t}}const c="sslinkdataobject",u={init(n){e.default.addAction("sslink",{text:t.default._t("CMS.LINKLABEL_PAGE","Link to an Object"),onclick:t=>t.execCommand(c),priority:53}).addCommandWithUrlTest(c,/^\[dataobject_link.+]$/),n.addCommand(c,()=>{(0,r.default)(`#${n.id}`).entwine("ss").openLinkDataObjectDialog()})}},p="insert-link__dialog-wrapper--dataobject",f=(0,l.loadComponent)((0,s.createInsertLinkModal)("SilverStripe\\Admin\\LeftAndMain","EditorDataObjectLink"));r.default.entwine("ss",e=>{e("textarea.htmleditor").entwine({openLinkDataObjectDialog(){let t=e(`#${p}`);t.length||(t=e(`<div id="${p}" />`),e("body").append(t)),t.addClass("insert-link__dialog-wrapper"),t.setElement(this),t.open()}}),e(`#${p}`).entwine({ReactRoot:null,renderModal(e){var n=this;ss.store,ss.apolloClient;const r=()=>this.close(),o=this.getOriginalAttributes(),s=this.getRequireLinkText();let l=this.getReactRoot();l||(l=(0,a.createRoot)(this[0]),this.setReactRoot(l)),l.render(i.default.createElement(f,{show:e,isOpen:e,onInsert:function(){return n.handleInsert(...arguments)},onHide:r,onClosed:r,title:t.default._t("CMS.LINK_PAGE","Link to a DataObject"),bodyClassName:"modal__dialog",className:p,fileAttributes:o,identifier:"Admin.InsertLinkDataObjectModal",requireLinkText:s}))},getRequireLinkText(){const t=this.getElement().getEditor().getInstance().selection,e=t.getContent()||"";return"A"!==t.getNode().tagName&&""===e.trim()},buildAttributes(t){const e=this._super(t),n=o.default.serialise({name:"dataobject_link",properties:{clazz:t.ClassName,id:t.ObjectID}},!0);return e.href=n,e},getOriginalAttributes(){const t=this.getElement().getEditor(),n=e(t.getSelectedNode()),i=n.attr("href")||"";if(!i)return{};const a=o.default.match("dataobject_link",!1,i);if(!a)return{};return{ClassName:a.original.match(/clazz=(.*?)\W/)[1],ObjectID:a.properties.id?parseInt(a.properties.id,10):0,Description:n.attr("title"),TargetBlank:!!n.attr("target")}}})}),tinymce.PluginManager.add(c,t=>u.init(t))}()}();